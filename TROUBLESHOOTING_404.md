# Troubleshooting 404 Errors on Render

If you're getting 404 errors when trying to log in or sign up, follow these steps:

## Step 1: Check Backend Service Status

1. Go to your Render dashboard
2. Click on the `finance-tracker-backend` service
3. Check the **Logs** tab to see if the server started successfully

**Look for these log messages:**
```
ðŸ“‹ Registering API routes...
  âœ“ /api/auth routes registered
âœ… All API routes registered successfully
ðŸš€ Server running on port 3000
```

**If you see errors instead:**
- Check for environment variable errors
- Check for database connection errors
- Check for import/module errors

## Step 2: Verify Environment Variables

Go to the backend service â†’ **Environment** tab and verify these are set:

### Required Variables:
- âœ… `DATABASE_URL` - Should be auto-set by Render
- âœ… `JWT_SECRET` - Should be auto-generated by Render
- âœ… `JWT_REFRESH_SECRET` - Should be auto-generated by Render
- âœ… `FRONTEND_URL` - **MUST BE SET MANUALLY**
- âœ… `ENCRYPTION_KEY` - Should be auto-generated by Render
- âœ… `NODE_ENV` - Should be `production`
- âœ… `PORT` - Should be `3000`

### Critical: Set FRONTEND_URL

The `FRONTEND_URL` must be set to your frontend's actual URL:

1. Go to your frontend service in Render
2. Copy the URL (e.g., `https://finance-tracker-frontend.onrender.com`)
3. Go to backend service â†’ Environment tab
4. Add/Update `FRONTEND_URL` with the frontend URL (without trailing slash)
5. **Restart the backend service** after updating

## Step 3: Test the Health Endpoint

Try accessing the health endpoint directly:
```
https://finance-tracker-backend.onrender.com/health
```

**Expected response:**
```json
{
  "status": "ok",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

**If this works:** The server is running, but routes might not be registered
**If this fails:** The server isn't running or crashed

## Step 4: Test the Auth Endpoint Directly

Try accessing the login endpoint directly:
```
POST https://finance-tracker-backend.onrender.com/api/auth/login
```

You can test this using:
- Browser DevTools â†’ Network tab
- Postman
- curl command

**Expected response (with valid credentials):**
```json
{
  "success": true,
  "data": {
    "user": {...},
    "accessToken": "...",
    "refreshToken": "..."
  }
}
```

**If you get 404:** Routes aren't registered (check logs)
**If you get 400:** Route exists but validation failed (good sign!)
**If you get 500:** Server error (check logs)

## Step 5: Check Frontend Environment Variables

Go to frontend service â†’ **Environment** tab and verify:

- âœ… `VITE_API_URL` - Should be `https://finance-tracker-backend.onrender.com/api`

**Important:** After updating `VITE_API_URL`, you need to **rebuild the frontend**:
1. Go to frontend service
2. Click **Manual Deploy** â†’ **Clear build cache & deploy**

## Step 6: Common Issues and Fixes

### Issue: Server crashes on startup
**Symptoms:** No logs, service shows "Failed" status
**Fix:** 
- Check environment variables are all set
- Check logs for specific error messages
- Verify database is accessible

### Issue: Routes not registered
**Symptoms:** Health endpoint works, but `/api/*` returns 404
**Fix:**
- Check logs for route registration errors
- Verify all route files are in the build output
- Check for TypeScript compilation errors

### Issue: CORS errors
**Symptoms:** Browser console shows CORS errors
**Fix:**
- Verify `FRONTEND_URL` is set correctly in backend
- Make sure there's no trailing slash in `FRONTEND_URL`
- Restart backend service after updating

### Issue: Database connection errors
**Symptoms:** Logs show database connection errors
**Fix:**
- Verify `DATABASE_URL` is set correctly
- Check database service is running
- Verify database credentials are correct

## Step 7: Rebuild and Redeploy

If nothing else works:

1. **Backend:**
   - Go to backend service
   - Click **Manual Deploy** â†’ **Clear build cache & deploy**

2. **Frontend:**
   - Go to frontend service
   - Click **Manual Deploy** â†’ **Clear build cache & deploy**

3. **Wait for deployment to complete** and check logs

## Still Having Issues?

1. Check the Render logs for specific error messages
2. Verify all environment variables are set correctly
3. Make sure both services are in "Live" status
4. Try accessing the health endpoint to verify server is running
5. Check browser console for additional error messages

## Quick Checklist

- [ ] Backend service shows "Live" status
- [ ] Frontend service shows "Live" status
- [ ] Database service shows "Available" status
- [ ] All environment variables are set
- [ ] `FRONTEND_URL` matches actual frontend URL
- [ ] `VITE_API_URL` is set to backend URL + `/api`
- [ ] Health endpoint (`/health`) returns 200 OK
- [ ] No errors in backend logs
- [ ] No errors in frontend logs

